<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>COSMIC SPORTS</title>

<link rel="icon" type="image/png" href="favicon.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Plyr -->
<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

<!-- Shaka (DASH) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.compiled.js"></script>

<!-- HLS -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.15"></script>
<script src="player.min.js"></script>

<style>
html, body {
  margin: 0;
  height: 100%;
  font-family: Arial, sans-serif;
}

body {
  background:
    radial-gradient(circle at top left, rgba(255,255,255,0.25), rgba(0,0,0,0.9)),
    url("bg.webp") center/cover no-repeat fixed;
  display: flex;
  justify-content: center;
  align-items: center;
}

.app {
  width: 100%;
  max-width: 1000px;
  padding: 16px;
}

.title {
  text-align: center;
  font-size: 32px;
  font-weight: bold;
  margin-bottom: 12px;
  color: #7fd7ff;
  text-shadow: 0 0 18px rgba(127,215,255,0.9);
}

.player-wrap {
  background: rgba(0,0,0,0.55);
  border-radius: 14px;
  padding: 10px;
}

video {
  width: 100%;
  border-radius: 10px;
}

/* Channel name below player */
.channel-name {
  margin-top: 10px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
  color: #7fd7ff;
  letter-spacing: 1px;
}
</style>
</head>

<body>

<div class="app">
  <div class="title">COSMIC SPORTS</div>

  <div class="player-wrap">
    <video id="video" controls playsinline></video>
  </div>

  <!-- CHANNEL NAME -->
  <div id="channelName" class="channel-name"></div>
</div>

<script>
/* =========================
   STREAM DATABASE
   ========================= */
const STREAMS = {
  willow: {
    name: "TNT SPORTS 4",
    type: "dash",
    manifest: "https://a201aivottlinear-a.akamaihd.net/OTTB/lhr-nitro/live/dash/enc/i2pcjr4pe5/out/v1/912e9db56d75403b8a9ac0a719110f36/cenc.mpd",
    keys: {
      "192b1115da041585c77200128549efa1": "634e10efe4abbb14be400a3ccbac0258"
    }
  },

  dice: {
    name: "SKY NZ UHD",
    type: "dash",
    manifest: "https://dice-live-oc.akamaized.net/hdntl=exp=1768143150~acl=%2f*~id=e86aef00-042a-464f-bbab-22abf9844c1a~data=hdntl,dWlkPTQwMTY0NnxkY2Uuc2t5bnomaXA9NzguMTQzLjIzNS4yMTgmZXhwPTE3NjgxNDMxNzgmZWlkPTIxOTAyNiZjaWQ9ZGNlLnNreW56Jm9pZD0zMTgmdHlwZT1MSVZF~hmac=6d22f4a965b8628edad10b37edf349aafef3cf73343adff5963b8bfb6fbfa066/dash/live/2093722/294921-313667/manifest-d.mpd",
    keys: {
      "4d346b1d1ae64d4a800409cffa14983e": "208c972bd2da4359ac94e6944fe378b6"
    }
  },

  willow_hls: {
    name: "HOTSTAR",
    type: "hls",
    manifest: "https://prod-fastly-eu-central-1.video.pscp.tv/Transcoding/v1/hls/JK1m8Z7AosNGJQczY94TOMNaULiQgE_V2Wy-hYBCHUPNELvsJjMcek5T85pzMpL7cPXST6cGnRiEwdgSYSC_Ww/non_transcode/eu-central-1/periscope-replay-direct-prod-eu-central-1-public/master_dynamic_highlatency.m3u8?type=live"
  }
};

/* =========================
   GET ?id=
   ========================= */
const id = new URLSearchParams(location.search).get("id");
if (!id || !STREAMS[id]) {
  alert("Use ?id=willow, ?id=dice, or ?id=willow_hls");
  throw new Error("Invalid ID");
}

const video = document.getElementById("video");
document.getElementById("channelName").innerText = STREAMS[id].name;

/* =========================
   INIT PLAYER
   ========================= */
async function init() {
  const stream = STREAMS[id];

  // DASH + ClearKey
  if (stream.type === "dash") {
    const shakaPlayer = new shaka.Player(video);
    shakaPlayer.configure({ drm: { clearKeys: stream.keys } });
    await shakaPlayer.load(stream.manifest);

    const tracks = shakaPlayer.getVariantTracks();
    const qualities = ["auto"];
    tracks.forEach(t => {
      if (t.height && !qualities.includes(t.height)) qualities.push(t.height);
    });
    qualities.sort((a, b) => b - a);

    new Plyr(video, {
      settings: ["quality", "speed"],
      quality: {
        default: "auto",
        options: qualities,
        forced: true,
        onChange: q => {
          if (q === "auto") {
            shakaPlayer.configure({ abr: { enabled: true } });
          } else {
            shakaPlayer.configure({ abr: { enabled: false } });
            const track = tracks.find(t => t.height == q);
            if (track) shakaPlayer.selectVariantTrack(track, true);
          }
        }
      }
    });
  }

  // HLS
  if (stream.type === "hls") {
    if (Hls.isSupported()) {
      const hls = new Hls();
      hls.loadSource(stream.manifest);
      hls.attachMedia(video);
    } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
      video.src = stream.manifest;
    }
    new Plyr(video, { settings: ["quality", "speed"] });
  }
}

init();
</script>

</body>
</html>
