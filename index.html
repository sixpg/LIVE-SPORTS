<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LIVE SPORTS</title>

<!-- Players -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mpegts.js@latest/dist/mpegts.min.js"></script>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0b0b0b;
        color: #fff;
    }

    header {
        padding: 12px;
        text-align: center;
        font-size: 22px;
        font-weight: bold;
        background: #111;
        border-bottom: 1px solid #222;
    }

    .container {
        display: flex;
        height: calc(100vh - 52px);
    }

    .channels {
        width: 30%;
        background: #121212;
        overflow-y: auto;
        border-right: 1px solid #222;
    }

    .channel {
        padding: 12px;
        cursor: pointer;
        border-bottom: 1px solid #1f1f1f;
        transition: background 0.2s;
    }

    .channel:hover {
        background: #1e1e1e;
    }

    .player {
        width: 70%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #000;
    }

    video {
        width: 100%;
        height: 100%;
        background: #000;
    }
</style>
</head>
<body>

<header>LIVE SPORTS</header>

<div class="container">
    <div class="channels" id="channels"></div>
    <div class="player">
        <video id="video" controls autoplay></video>
    </div>
</div>

<script>
const M3U_URL = "https://cosmicsports.pages.dev/playlist/sports.m3u";

const video = document.getElementById("video");
const channelList = document.getElementById("channels");

let hls, dashPlayer, tsPlayer;

function clearPlayers() {
    if (hls) { hls.destroy(); hls = null; }
    if (dashPlayer) { dashPlayer.reset(); dashPlayer = null; }
    if (tsPlayer) { tsPlayer.destroy(); tsPlayer = null; }
    video.src = "";
}

function playStream(url) {
    clearPlayers();

    if (url.endsWith(".m3u8")) {
        if (Hls.isSupported()) {
            hls = new Hls();
            hls.loadSource(url);
            hls.attachMedia(video);
        } else {
            video.src = url;
        }
    } 
    else if (url.endsWith(".mpd")) {
        dashPlayer = dashjs.MediaPlayer().create();
        dashPlayer.initialize(video, url, true);
    } 
    else if (url.endsWith(".ts")) {
        if (mpegts.getFeatureList().mseLivePlayback) {
            tsPlayer = mpegts.createPlayer({
                type: "mpegts",
                url: url,
                isLive: true
            });
            tsPlayer.attachMediaElement(video);
            tsPlayer.load();
            tsPlayer.play();
        } else {
            alert("MPEG-TS not supported in this browser");
        }
    } 
    else {
        alert("Unknown stream format");
    }
}

fetch(M3U_URL)
.then(res => res.text())
.then(text => {
    const lines = text.split("\n");
    let name = "";

    lines.forEach(line => {
        line = line.trim();
        if (line.startsWith("#EXTINF")) {
            name = line.split(",").pop();
        } 
        else if (line && !line.startsWith("#")) {
            const channel = document.createElement("div");
            channel.className = "channel";
            channel.textContent = name || "Live Channel";
            channel.onclick = () => playStream(line);
            channelList.appendChild(channel);
        }
    });
});
</script>

</body>
</html>
